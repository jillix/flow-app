#!/usr/bin/env node

// TODO better arguments parsing with optimist or similar

// read CLI arguments
var repo = process.argv[2];
var port = process.argv[3];
var logLevel = process.argv[4];
var production = process.argv[5] === 'PRO' ? true : false;
var token = process.argv[6] ? process.argv[6] : null;

// check the CLI arguments
if (!repo || !port || !logLevel) {
    throw new Error('Invalid CLI arguments. Example: ./engine /absolute/path/to/repo [PORT] ["fatal|error|warn|info|debug|trace"] ["PRO"]');
}

// start engine
require('./lib/server')(repo, port, logLevel, production, token);

/*
// Start forking if you are the master.
cluster = require('cluster')
numCPUs = require('os').cpus().length;

if (cluster.isMaster) {
    for (var i = 0; i < numCPUs; i++) { cluster.fork() }
} else { workers() }
*/
